<% breadcrumb :users_show %>

<div class="contents">
  <h3 class="contents-title">„É¶„Éº„Ç∂„ÉºÊÉÖÂ†±</h3>

  <div class="user">
    <%= image_tag @user.image.url, alt: "„É¶„Éº„Ç∂„ÉºÁîªÂÉè" %>
    <h2><%= @user.name %><span> „Åï„Çì</span></h2>
    <% if @user.id == @current_user.id %>
      <p><%= @user.email %></p>
    <% end %>
    <p><%= @user.profile %></p>

    <ul class="profile-links">
      <% if @user.youtube.present? %>
        <li class="profile-link">
          <%= link_to @user.youtube, target: :_blank do %>
            <i class="fab fa-youtube fa-2x"></i>
          <% end %>
        </li>
      <% end %>
      <% if @user.twitter.present? %>
        <li class="profile-link">
          <%= link_to @user.twitter, target: :_blank do %>
            <i class="fab fa-twitter fa-2x"></i>
          <% end %>
        </li>
      <% end %>
      <% if @user.instagram.present? %>
        <li class="profile-link">
          <%= link_to @user.instagram, target: :_blank do %>
            <i class="fab fa-instagram fa-2x"></i>
          <% end %>
        </li>
      <% end %>
    </ul>

    <% if @user.id == @current_user.id %>
      <div class="user-edit">
        <%= link_to("Á∑®ÈõÜ„Åô„Çã", "/users/#{@user.id}/edit") %>
        <script>
          function confirmDelete(userId) {
            if (confirm('Êú¨ÂΩì„Å´„Åì„ÅÆ„É¶„Éº„Ç∂„Éº„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü')) {
              window.location.href = '/users/' + userId;
            }
          }
        </script>
        <%= link_to 'ÈÄÄ‰ºö„Åô„Çã', user_path(@user), method: :delete, data: { confirm: 'Êú¨ÂΩì„Å´ÈÄÄ‰ºö„Åó„Åæ„Åô„ÅãÔºü' } %>
      </div>
    <% end %>
    <% if @current_user != @user %>
      <% if @current_user.following?(@user) %>
        <%= link_to "„Éï„Ç©„É≠„ÉºÂ§ñ„Åô", user_relationships_path(@user.id), method: :delete %>
      <% else %>
        <%= link_to "„Éï„Ç©„É≠„Éº„Åô„Çã", user_relationships_path(@user.id), method: :post %>
      <% end %>
    <% end %>

    <span>„Éï„Ç©„É≠„Éº‰∏≠</span><%= link_to @user.followings.count, user_followings_path(@user)%>
    <span>„Éï„Ç©„É≠„ÉØ„Éº</span><%= link_to @user.followers.count, user_followers_path(@user) %>
  </div>

  <h3 class="contents-title">Èá£Êûú‰∏ÄË¶ß</h3>

  <div class="posts-contents">
    <% @user.posts.each do |post| %>
      <div class="posts-item">
        <div class="user-post-datetime">
          <span>ÊäïÁ®øÊó•Ôºö</span>
          <%= post.created_at.strftime("%Y-%m-%d %H:%M") %>
        </div>

        <div class="top-user-image">
          <% if post.images.length < 2 %>
            <% post.images.each do |image| %>
              <%= image_tag image.to_s, class: "post-img", alt: "ÊäïÁ®ø„Åï„Çå„ÅüÈá£ÊûúÁîªÂÉèÔºàÂçòÊûöÔºâ" %>
            <% end %>
          <% else %>
            <div class="swiper">
              <div class= "swiper-wrapper ">
                <% post.images.each do |image| %>
                  <%= image_tag image.to_s, class: "swiper-slide index-img", alt: "ÊäïÁ®ø„Åï„Çå„ÅüÈá£ÊûúÁîªÂÉèÔºàË§áÊï∞ÊûöÔºâ" %>
                <% end %>
              </div>
              <div class="swiper-button-prev"></div>
              <div class="swiper-button-next"></div>
              <div class="swiper-pagination"></div>
            </div>
          <% end %>
        </div>

        <div class="posts-index-right">
          <%= link_to("üëâÈá£ÊûúË©≥Á¥∞","/posts/#{post.id}") %>
        </div>
      </div>
    <% end %>
  </div>
</div>

<% if @current_user && @posts or @post or @user %>
  <p id="page-top"><%= link_to("Èá£Êûú„ÇíÊäïÁ®ø„Åô„Çã","/posts/new") %></p>
<% end %>

<% if @current_user == nil %>
  <p id="page-top"><%= link_to("Êñ∞Ë¶èÁôªÈå≤„Åô„Çã","/signup") %></p>
<% end %>

<div class="go-home">
  <%= link_to("<„É¶„Éº„Ç∂‰∏ÄË¶ß„Å´Êàª„Çã>","/users/index") %>
</div>
